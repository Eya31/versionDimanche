<div class="demandes-terminees-page">
  <!-- HEADER -->
  <header class="header">
    <div class="container">
      <nav class="navbar">
        <div class="logo">
          <a routerLink="/"><h1>{{ 'visiteur.platformTitle' | translate }}</h1></a>
        </div>
        <ul class="nav-links">
          <li><a routerLink="/" routerLinkActive="active">{{ 'visiteur.home' | translate }}</a></li>
          <li><a routerLink="/demandes-terminees" routerLinkActive="active">{{ 'visiteur.demandesTerminees' | translate }}</a></li>
          <li><a routerLink="/faq" routerLinkActive="active">{{ 'visiteur.faq' | translate }}</a></li>
          <li><a routerLink="/about" routerLinkActive="active">{{ 'visiteur.about' | translate }}</a></li>
          <li><a routerLink="/login" routerLinkActive="active">{{ 'visiteur.connection' | translate }}</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="container main-content">
    <h1 class="page-title">{{ 'visiteur.demandesTermineesPage' | translate }}</h1>
    <p class="page-subtitle">{{ 'visiteur.demandesTermineesSubtitle' | translate }}</p>

    <!-- FILTRES -->
    <div class="filters-section">
      <h2>{{ 'visiteur.filters' | translate }}</h2>
      <div class="filters-grid">
        <div class="filter-group">
          <label for="category">{{ 'visiteur.category' | translate }}</label>
          <select id="category" [(ngModel)]="categoryFilter" (change)="applyFilters()">
            <option value="">{{ 'visiteur.allCategories' | translate }}</option>
            <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="dateDebut">{{ 'visiteur.dateDebut' | translate }}</label>
          <input type="date" id="dateDebut" [(ngModel)]="dateDebutFilter" (change)="applyFilters()" />
        </div>
        <div class="filter-group">
          <label for="dateFin">{{ 'visiteur.dateFin' | translate }}</label>
          <input type="date" id="dateFin" [(ngModel)]="dateFinFilter" (change)="applyFilters()" />
        </div>
        <div class="filter-group">
          <button type="button" class="btn btn-secondary" (click)="clearFilters()">
            {{ 'visiteur.reset' | translate }}
          </button>
        </div>
      </div>
    </div>

    <!-- LISTE DES DEMANDES -->
    <div *ngIf="loading" class="loading">{{ 'visiteur.loadingDemands' | translate }}</div>
    
    <div *ngIf="!loading && demandesFiltrees.length === 0" class="no-data">
      <p>{{ 'visiteur.noCriteriaMatch' | translate }}</p>
    </div>

    <div *ngIf="!loading && demandesFiltrees.length > 0" class="demandes-list">
      <div *ngFor="let demande of demandesFiltrees" class="demande-item">
        <div *ngIf="demande.photos && demande.photos.length > 0" class="demande-photo">
          <img [src]="demande.photos[0].url" [alt]="demande.photos[0].nom" />
        </div>
        <div class="demande-info">
          <div class="demande-header">
            <h3>{{ translationService.translateCategory(demande.category) || ('visiteur.request' | translate) }}</h3>
            <span class="badge badge-success">{{ 'visiteur.terminated' | translate }}</span>
          </div>
          <p class="demande-description">{{ demande.description }}</p>
          <div class="demande-meta">
            <span class="meta-item">
              <i class="icon-calendar"></i>
              {{ demande.dateSoumission | date:'dd/MM/yyyy' }}
            </span>
            <span *ngIf="demande.localisation?.address" class="meta-item">
              <i class="icon-location"></i>
              {{ demande.localisation?.address }}
            </span>
          </div>
          <a [routerLink]="['/demande', demande.id]" class="btn btn-primary">
            {{ 'visiteur.viewDetails' | translate }}
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      <p>{{ 'visiteur.copyright' | translate }}</p>
    </div>
  </footer>
</div>

