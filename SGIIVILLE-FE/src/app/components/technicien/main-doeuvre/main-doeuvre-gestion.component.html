<!-- ============================================
     GESTION MAIN D'Å’UVRE - INTERFACE HARMONISÃ‰E
     ============================================ -->

<div class="main-doeuvre-gestion">
  <!-- HEADER -->
  <header class="overview-header">
    <div class="header-content">
      <h1>ğŸ› ï¸ Gestion des Fiches de Main d'Å’uvre</h1>
      <p class="subtitle">
        CrÃ©ez et gÃ©rez les fiches de main d'Å“uvre avec comptes utilisateurs. Les agents peuvent se connecter pour consulter leurs interventions.
      </p>
    </div>
    <div class="header-actions">
      <button class="btn-primary" (click)="creerNouveau()" [attr.aria-label]="'CrÃ©er une nouvelle fiche'">
        â• Nouvelle Fiche
      </button>
      <button class="btn-secondary" (click)="retour()" [attr.aria-label]="'Retour au dashboard'">
        <span class="icon">â†</span>
        Retour
      </button>
    </div>
  </header>

  <!-- Filtres et Recherche -->
  <div class="card">
    <div class="card-header">
      <h2>ğŸ” Recherche et Filtres</h2>
    </div>
    <div class="card-body">
    
    <div class="search-box">
      <input 
        type="text" 
        [(ngModel)]="recherche" 
        (input)="appliquerFiltres()"
        placeholder="Rechercher par nom, prÃ©nom, matricule, compÃ©tence..."
        [attr.aria-label]="'Rechercher une fiche'">
    </div>
    
    <div class="filters">
      <select 
        [(ngModel)]="filtreCompetence" 
        (change)="loadMainDOeuvre()"
        [attr.aria-label]="'Filtrer par compÃ©tence'">
        <option value="">Toutes les compÃ©tences</option>
        <option *ngFor="let comp of competencesDisponibles" [value]="comp">{{comp}}</option>
      </select>
      
      <select 
        [(ngModel)]="filtreDisponibilite" 
        (change)="loadMainDOeuvre()"
        [attr.aria-label]="'Filtrer par disponibilitÃ©'">
        <option value="">Toutes les disponibilitÃ©s</option>
        <option value="DISPONIBLE">âœ… Disponible</option>
        <option value="OCCUPE">ğŸ”„ OccupÃ©</option>
        <option value="CONFLIT">âš ï¸ Conflit d'horaires</option>
        <option value="EN_CONGE">ğŸ–ï¸ En congÃ©</option>
        <option value="ABSENT">ğŸ¥ Absent</option>
        <option value="HORS_HABILITATION">â›” Hors habilitation</option>
      </select>
    </div>
    </div>
  </div>

  <!-- Formulaire crÃ©ation/Ã©dition -->
  <div *ngIf="isCreating || isEditing" class="card form-card">
    <div class="form-card-header">
      <div class="form-header-content">
        <div class="form-icon">{{isCreating ? 'â•' : 'âœï¸'}}</div>
        <div>
          <h2>{{isCreating ? 'Nouvelle Fiche de Main d\'Å’uvre' : 'Modifier Fiche'}}</h2>
          <p class="form-description" *ngIf="isCreating">
            CrÃ©ez une fiche de main d'Å“uvre avec un compte utilisateur. L'agent pourra se connecter 
            pour consulter ses interventions. <strong>L'email est obligatoire</strong> pour crÃ©er le compte.
          </p>
          <p class="form-description" *ngIf="isEditing">
            Modifiez les informations de la fiche de main d'Å“uvre.
          </p>
        </div>
      </div>
      <button type="button" class="btn-close-form" (click)="annuler()" [attr.aria-label]="'Fermer le formulaire'">
        âœ•
      </button>
    </div>
    <div class="form-card-body">
    
    <form (ngSubmit)="sauvegarder()" class="main-form">
      <!-- Section: Informations Personnelles -->
      <div class="form-section-wrapper">
        <div class="section-header">
          <span class="section-icon">ğŸ‘¤</span>
          <h3 class="section-title">Informations Personnelles</h3>
        </div>
        <div class="form-grid">
          <div class="form-field">
            <label class="form-label">
              <span class="label-text">Nom</span>
              <span class="required-badge">*</span>
            </label>
            <input 
              type="text" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.nom" 
              name="nom"
              required
              placeholder="Nom de famille">
          </div>
          
          <div class="form-field">
            <label class="form-label">
              <span class="label-text">PrÃ©nom</span>
            </label>
            <input 
              type="text" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.prenom" 
              name="prenom"
              placeholder="PrÃ©nom">
          </div>
          
          <div class="form-field">
            <label class="form-label">
              <span class="label-text">Matricule Interne</span>
            </label>
            <input 
              type="text" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.matricule" 
              name="matricule"
              placeholder="Ex: MO-001">
          </div>
          
          <div class="form-field">
            <label class="form-label">
              <span class="label-text">CIN</span>
              <span class="required-badge">*</span>
            </label>
            <input 
              type="text" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.cin" 
              name="cin"
              required
              placeholder="NumÃ©ro CIN">
          </div>
          
          <div class="form-field">
            <label class="form-label">
              <span class="label-text">TÃ©lÃ©phone</span>
              <span class="required-badge">*</span>
            </label>
            <input 
              type="tel" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.telephone" 
              name="telephone"
              required
              placeholder="+216 XX XXX XXX">
          </div>
          
          <div class="form-field">
            <label class="form-label">
              <span class="label-text">MÃ©tier</span>
            </label>
            <input 
              type="text" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.metier" 
              name="metier"
              placeholder="Ex: Ã‰lectricien, Plombier, MaÃ§on...">
          </div>
          
          <div class="form-field">
            <label class="form-label">
              <span class="label-text">Email</span>
              <span *ngIf="isCreating" class="required-badge">*</span>
            </label>
            <input 
              type="email" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.email" 
              name="email"
              [required]="isCreating"
              placeholder="email@example.com">
            <p class="form-hint" *ngIf="isCreating">
              <span class="hint-icon">âš ï¸</span>
              Obligatoire : Un compte utilisateur sera crÃ©Ã© avec cet email. Le mot de passe par dÃ©faut sera le matricule ou le CIN.
            </p>
          </div>

          <div class="form-field">
            <label class="form-label">
              <span class="label-text">Photo (URL ou chemin)</span>
            </label>
            <input 
              type="text" 
              class="form-input"
              [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.photoPath" 
              name="photoPath"
              placeholder="/photos/agent.jpg ou URL">
            <p class="form-hint">
              <span class="hint-icon">â„¹ï¸</span>
              Optionnel : Chemin vers la photo de l'agent
            </p>
          </div>
        </div>
      </div>

      <!-- Section: CompÃ©tences -->
      <div class="form-section-wrapper">
        <div class="section-header">
          <span class="section-icon">ğŸ¯</span>
          <h3 class="section-title">CompÃ©tences</h3>
        </div>
        <p class="section-description">SÃ©lectionnez les compÃ©tences de ce membre</p>
        <div class="checkbox-group-modern">
          <label *ngFor="let comp of competencesDisponibles" class="checkbox-modern">
            <input 
              type="checkbox" 
              [checked]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.competences.includes(comp)"
              (change)="toggleCompetence(comp, isCreating)">
            <span class="checkbox-custom"></span>
            <span class="checkbox-text">{{comp}}</span>
          </label>
        </div>
      </div>

      <!-- Section: Habilitations -->
      <div class="form-section-wrapper">
        <div class="section-header">
          <span class="section-icon">ğŸ›¡ï¸</span>
          <h3 class="section-title">Habilitations</h3>
        </div>
        <p class="section-description">SÃ©lectionnez les habilitations et dÃ©finissez leurs dates d'expiration</p>
        <div class="habilitations-list-modern">
          <div *ngFor="let hab of habilitationsDisponibles" class="habilitation-item-modern">
            <label class="checkbox-modern">
              <input 
                type="checkbox" 
                [checked]="((isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.habilitations || []).includes(hab)"
                (change)="toggleHabilitation(hab, isCreating)">
              <span class="checkbox-custom"></span>
              <span class="checkbox-text">{{hab}}</span>
            </label>
            <div *ngIf="((isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.habilitations || []).includes(hab)" 
                 class="habilitation-date-modern">
              <label class="date-label">Date d'expiration</label>
              <input 
                type="date"
                class="form-input date-input"
                [value]="getHabilitationExpiration(hab, isCreating)"
                (change)="updateHabilitationExpiration(hab, $any($event.target).value, isCreating)"
                placeholder="Date d'expiration">
            </div>
          </div>
        </div>
      </div>

      <!-- Section: Horaires de travail -->
      <div class="form-section-wrapper">
        <div class="section-header">
          <span class="section-icon">â°</span>
          <h3 class="section-title">Horaires de Travail</h3>
        </div>
        <p class="section-description">DÃ©finissez les horaires de travail pour chaque jour (format: 08:00-17:00)</p>
        <div class="horaires-grid-modern">
          <div *ngFor="let jour of joursSemaine" class="horaire-item-modern">
            <label class="horaire-label">{{jour}}</label>
            <input 
              type="text" 
              class="form-input horaire-input"
              [value]="getHorairesTravail(jour, isCreating)"
              (change)="updateHorairesTravail(jour, $any($event.target).value, isCreating)"
              placeholder="08:00-17:00"
              pattern="\d{2}:\d{2}-\d{2}:\d{2}">
          </div>
        </div>
      </div>

      <!-- Section: CongÃ©s -->
      <div class="form-section-wrapper">
        <div class="section-header">
          <span class="section-icon">ğŸ–ï¸</span>
          <h3 class="section-title">CongÃ©s</h3>
        </div>
        <p class="section-description">Ajoutez les dates de congÃ©s de l'agent</p>
        <div class="dates-list-modern">
          <div class="date-input-group-modern">
            <input 
              type="date" 
              class="form-input"
              [(ngModel)]="nouveauConge"
              name="nouveauConge"
              placeholder="Date de congÃ©">
            <button type="button" class="btn-add-date" (click)="ajouterConge(isCreating)">
              <span class="btn-icon">â•</span>
              <span>Ajouter</span>
            </button>
          </div>
          <div *ngIf="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.conges && (isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.conges!.length > 0" 
               class="dates-tags-modern">
            <span *ngFor="let conge of (isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.conges" 
                  class="date-tag-modern conge">
              <span>{{conge | date:'shortDate'}}</span>
              <button type="button" class="btn-remove-modern" (click)="retirerConge(conge, isCreating)">âœ•</button>
            </span>
          </div>
        </div>
      </div>

      <!-- Section: Absences -->
      <div class="form-section-wrapper">
        <div class="section-header">
          <span class="section-icon">ğŸ¥</span>
          <h3 class="section-title">Absences</h3>
        </div>
        <p class="section-description">Ajoutez les dates d'absences (maladie, permission, etc.)</p>
        <div class="dates-list-modern">
          <div class="date-input-group-modern">
            <input 
              type="date" 
              class="form-input"
              [(ngModel)]="nouvelleAbsence"
              name="nouvelleAbsence"
              placeholder="Date d'absence">
            <button type="button" class="btn-add-date" (click)="ajouterAbsence(isCreating)">
              <span class="btn-icon">â•</span>
              <span>Ajouter</span>
            </button>
          </div>
          <div *ngIf="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.absences && (isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.absences!.length > 0" 
               class="dates-tags-modern">
            <span *ngFor="let absence of (isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.absences" 
                  class="date-tag-modern absence">
              <span>{{absence | date:'shortDate'}}</span>
              <button type="button" class="btn-remove-modern" (click)="retirerAbsence(absence, isCreating)">âœ•</button>
            </span>
          </div>
        </div>
      </div>

      <!-- Section: Statut -->
      <div class="form-section-wrapper">
        <div class="section-header">
          <span class="section-icon">ğŸ“Š</span>
          <h3 class="section-title">Statut Initial</h3>
        </div>
        <p class="section-description">Le statut sera mis Ã  jour automatiquement lors des affectations</p>
        <div class="form-field">
          <select 
            [(ngModel)]="(isCreating ? nouveauMainDOeuvre : selectedMainDOeuvre)!.disponibilite" 
            name="disponibilite"
            class="form-select">
            <option value="DISPONIBLE">âœ… Disponible</option>
            <option value="OCCUPE">ğŸ”„ OccupÃ©</option>
            <option value="CONFLIT">âš ï¸ Conflit d'horaires</option>
            <option value="EN_CONGE">ğŸ–ï¸ En congÃ©</option>
            <option value="ABSENT">ğŸ¥ Absent</option>
            <option value="HORS_HABILITATION">â›” Hors habilitation</option>
          </select>
        </div>
      </div>

      <div class="form-actions-modern">
        <button type="button" class="btn-cancel" (click)="annuler()">
          <span class="btn-icon">âœ•</span>
          <span>Annuler</span>
        </button>
        <button type="submit" class="btn-submit">
          <span class="btn-icon">ğŸ’¾</span>
          <span>Enregistrer</span>
        </button>
      </div>
    </form>
    </div>
  </div>

  <!-- Liste des fiches -->
  <div class="main-doeuvre-list">
    <div *ngFor="let md of mainDOeuvreFiltree; trackBy: trackByMainDOeuvreId" class="main-doeuvre-card" [class.archived]="!md.active">
      <!-- Card Header -->
      <div class="card-header">
        <div class="header-left-with-photo">
          <div class="agent-photo-wrapper">
            <div *ngIf="md.photoPath" class="agent-photo">
              <img [src]="md.photoPath" [alt]="md.nom + ' ' + md.prenom" onerror="this.style.display='none'">
            </div>
            <div *ngIf="!md.photoPath" class="agent-photo-placeholder">
              <span>{{(md.nom || 'A')[0]}}{{md.prenom ? (md.prenom[0] || '') : ''}}</span>
            </div>
            <div class="status-indicator" [ngClass]="'status-' + (md.disponibilite || 'DISPONIBLE').toLowerCase()"></div>
          </div>
          <div class="agent-info-header">
            <h3>{{md.nom}} {{md.prenom || ''}}</h3>
            <p class="card-subtitle">
              <span class="id-badge">#{{md.id}}</span>
              <span *ngIf="md.matricule" class="matricule-badge">{{md.matricule}}</span>
            </p>
          </div>
        </div>
        <span class="badge" [ngClass]="getBadgeDisponibiliteClass(md.disponibilite)">
          {{getDisponibiliteLabel(md.disponibilite)}}
        </span>
      </div>
      
      <!-- Card Body -->
      <div class="card-body">
        <!-- Informations principales -->
        <div class="info-section">
          <h4 class="section-title">ğŸ“‹ Informations</h4>
          <div class="info-grid-card">
            <div class="info-item-card" *ngIf="md.cin">
              <div class="info-icon">ğŸ†”</div>
              <div class="info-content">
                <strong>CIN</strong>
                <span>{{md.cin}}</span>
              </div>
            </div>
            
            <div class="info-item-card" *ngIf="md.telephone">
              <div class="info-icon">ğŸ“</div>
              <div class="info-content">
                <strong>TÃ©lÃ©phone</strong>
                <span>{{md.telephone}}</span>
              </div>
            </div>
            
            <div class="info-item-card" *ngIf="md.metier">
              <div class="info-icon">ğŸ”§</div>
              <div class="info-content">
                <strong>MÃ©tier</strong>
                <span>{{md.metier}}</span>
              </div>
            </div>

            <div class="info-item-card" *ngIf="md.email">
              <div class="info-icon">ğŸ“§</div>
              <div class="info-content">
                <strong>Email</strong>
                <span>{{md.email}}</span>
                <span class="badge-compte">âœ“ Compte crÃ©Ã©</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- CompÃ©tences -->
        <div *ngIf="md.competences && md.competences.length > 0" class="info-section">
          <h4 class="section-title">ğŸ¯ CompÃ©tences</h4>
          <div class="tags-list">
            <span *ngFor="let comp of md.competences" class="tag tag-competence">
              <span class="tag-icon">âœ“</span>
              {{comp}}
            </span>
          </div>
        </div>
        
        <!-- Habilitations avec dates d'expiration -->
        <div *ngIf="md.habilitations && md.habilitations.length > 0" class="info-section">
          <h4 class="section-title">ğŸ›¡ï¸ Habilitations</h4>
          <div class="tags-list">
            <span *ngFor="let hab of md.habilitations" 
                  class="tag tag-habilitation"
                  [class.expired]="isHabilitationExpiree(hab, md)">
              <span class="tag-icon" [class.expired-icon]="isHabilitationExpiree(hab, md)">âš </span>
              {{hab}}
              <span *ngIf="md.habilitationsExpiration && md.habilitationsExpiration[hab]" 
                    class="expiration-date">
                (Exp: {{md.habilitationsExpiration[hab] | date:'shortDate'}})
              </span>
              <span *ngIf="isHabilitationExpiree(hab, md)" class="expired-badge">ExpirÃ©e</span>
            </span>
          </div>
        </div>

        <!-- Horaires de travail -->
        <div *ngIf="md.horairesTravail && hasHoraires(md.horairesTravail)" class="info-section">
          <h4 class="section-title">â° Horaires de travail</h4>
          <div class="horaires-list">
            <ng-container *ngFor="let jour of joursSemaine">
              <span *ngIf="md.horairesTravail && md.horairesTravail[jour]"
                    class="horaire-badge">
                <span class="horaire-day">{{jour.substring(0, 3)}}</span>
                <span class="horaire-time">{{md.horairesTravail[jour]}}</span>
              </span>
            </ng-container>
          </div>
        </div>

        <!-- CongÃ©s et absences -->
        <div *ngIf="(md.conges && md.conges.length > 0) || (md.absences && md.absences.length > 0)" class="info-section">
          <h4 class="section-title">ğŸ“… DisponibilitÃ©</h4>
          <div class="dates-display">
            <div *ngIf="md.conges && md.conges.length > 0" class="dates-group">
              <strong class="dates-label">ğŸ–ï¸ CongÃ©s ({{md.conges.length}}):</strong>
              <div class="dates-tags">
                <span *ngFor="let conge of md.conges" class="date-tag conge">{{conge | date:'dd/MM'}}</span>
              </div>
            </div>
            <div *ngIf="md.absences && md.absences.length > 0" class="dates-group">
              <strong class="dates-label">ğŸ¥ Absences ({{md.absences.length}}):</strong>
              <div class="dates-tags">
                <span *ngFor="let absence of md.absences" class="date-tag absence">{{absence | date:'dd/MM'}}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Historique -->
        <div *ngIf="md.historiqueInterventionIds && md.historiqueInterventionIds.length > 0" class="info-section historique-section">
          <div class="historique-info">
            <div class="historique-icon">ğŸ“Š</div>
            <div class="historique-content">
              <strong>Interventions rÃ©alisÃ©es</strong>
              <span class="historique-count">{{md.historiqueInterventionIds.length}} intervention(s)</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Card Actions -->
      <div class="card-actions">
        <button 
          class="btn-action btn-edit" 
          (click)="editer(md)" 
          [attr.aria-label]="'Modifier la fiche de ' + md.nom"
          [disabled]="!md.active">
          <span class="btn-icon">âœï¸</span>
          <span class="btn-text">Modifier</span>
        </button>
        <button 
          class="btn-action btn-history" 
          (click)="voirHistorique(md)" 
          [attr.aria-label]="'Voir l\'historique de ' + md.nom"
          [disabled]="!md.historiqueInterventionIds || md.historiqueInterventionIds.length === 0">
          <span class="btn-icon">ğŸ“Š</span>
          <span class="btn-text">Historique</span>
        </button>
        <button 
          class="btn-action btn-archive" 
          (click)="archiver(md)" 
          [attr.aria-label]="'Archiver la fiche de ' + md.nom"
          [disabled]="!md.active">
          <span class="btn-icon">ğŸ—„ï¸</span>
          <span class="btn-text">Archiver</span>
        </button>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="mainDOeuvreFiltree.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ‘·</div>
      <h3>Aucune fiche de main d'Å“uvre trouvÃ©e</h3>
      <p class="empty-message">
        CrÃ©ez votre premiÃ¨re fiche ou modifiez vos filtres de recherche.
      </p>
      <button class="btn-primary" (click)="creerNouveau()">
        â• CrÃ©er une fiche
      </button>
    </div>
  </div>

  <!-- Modal Historique -->
  <div *ngIf="showHistorique && selectedMainDOeuvreForHistorique" class="modal-overlay" (click)="fermerHistorique()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>ğŸ“Š Historique des Interventions</h2>
        <button class="btn-close" (click)="fermerHistorique()">âœ•</button>
      </div>
      <div class="modal-body">
        <p class="agent-info">
          <strong>{{selectedMainDOeuvreForHistorique.nom}} {{selectedMainDOeuvreForHistorique.prenom || ''}}</strong>
          <span *ngIf="selectedMainDOeuvreForHistorique.matricule"> - Matricule: {{selectedMainDOeuvreForHistorique.matricule}}</span>
        </p>
        
        <div *ngIf="historique.length === 0" class="empty-state">
          <p>Aucune intervention enregistrÃ©e</p>
        </div>
        
        <div *ngIf="historique.length > 0" class="historique-list">
          <!-- Statistiques globales -->
          <div class="historique-stats">
            <div class="stat-item">
              <strong>Total interventions:</strong>
              <span>{{historique.length}}</span>
            </div>
            <div class="stat-item">
              <strong>Temps total travaillÃ©:</strong>
              <span>{{calculerTempsTotal()}} minutes ({{formatTempsTotal()}})</span>
            </div>
            <div class="stat-item">
              <strong>Interventions terminÃ©es:</strong>
              <span>{{compterTerminees()}}</span>
            </div>
          </div>

          <!-- Liste des interventions -->
          <div *ngFor="let hist of historique" class="historique-item">
            <div class="historique-header">
              <h4>Intervention #{{hist.interventionId}}</h4>
              <span class="badge" [class]="'etat-' + (hist.etat || 'INCONNU').toLowerCase()">{{hist.etat || 'INCONNU'}}</span>
            </div>
            <p class="historique-description">{{hist.description}}</p>
            <div class="historique-details">
              <div class="detail-item">
                <strong>Date dÃ©but:</strong>
                <span>{{hist.dateDebut | date:'short'}}</span>
              </div>
              <div *ngIf="hist.dateFin" class="detail-item">
                <strong>Date fin:</strong>
                <span>{{hist.dateFin | date:'short'}}</span>
              </div>
              <div class="detail-item">
                <strong>Temps passÃ©:</strong>
                <span>{{hist.tempsPasseMinutes}} minutes ({{formatTemps(hist.tempsPasseMinutes)}})</span>
              </div>
              <div *ngIf="hist.competencesUtilisees && hist.competencesUtilisees.length > 0" class="detail-item">
                <strong>CompÃ©tences utilisÃ©es:</strong>
                <div class="tags-list">
                  <span *ngFor="let comp of hist.competencesUtilisees" class="tag tag-competence">{{comp}}</span>
                </div>
              </div>
              <div *ngIf="hist.resultat" class="detail-item">
                <strong>RÃ©sultat:</strong>
                <span class="resultat-badge" [class]="'resultat-' + (hist.resultat || 'inconnu').toLowerCase()">{{hist.resultat || 'N/A'}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" (click)="fermerHistorique()">Fermer</button>
      </div>
    </div>
  </div>
</div>
